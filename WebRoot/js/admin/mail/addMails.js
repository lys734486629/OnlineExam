var groupObj={getGroupListTreeClickFun:function(c){getTree({targetId:"group_id",callbackFn:function(b){window.L.each(b,function(a,b){idList[a]=b[a].id;nameList[a]=b[a].name},idList=[],nameList=[]);$(c).attr("key",idList.join(",")).val(nameList.join(","))},dataType:"group",isExpand:!1,showRoot:!1,isCheckBox:!0,chkboxType:{Y:"s",N:"ps"}})}};
function showUserList(c){var b="",a="",d;for(d in c)b+=c[d].name+",",a+=c[d].id+",";$("#user_name").attr("value",b.substring(0,b.length-1));$("#user_id").attr("value",a.substr(0,a.length-1))}
if(window.L.openCom("oEditor"))var oEditorObj=(new oEditor({buttonList:"bold italic underline left center right justify ol ul fontSize fontFamily fontFormat image forecolor bgcolor table subscript superscript strikethrough removeformat hr media".split(" "),maxHeight:300,CustomConfig:{AnswerSelect:{AnswerType:"textbox"},oFileManager:{quickUploadDir:{img:"/pictures/..quickUpload",media:"/media/..quickUpload",attachment:"/attachment/..quickUpload"},browseDir:{img:"/pictures",media:"/media",attachment:"/attachment"}}}})).panelInstance("mailContent");
function save(){var c=$("#title").val(),b=$("#mailContent").val(),a=$("#Attachment").val(),d=$("#user_id").val(),e=$("#group_id").attr("key");if("0"==e&&""==d)return window.L.openCom("tip")(window.L.getText("\u6ca1\u6709\u6570\u636e")),!1;window.L.openCom("tip")(window.L.getText("\u6b63\u5728\u5904\u7406..."),!1);$.ajax({url:"./mServerCtl.php?a=sendMails",timeout:5E3,type:"POST",data:{user:d,group:e,title:c,content:b,Attachment:a},error:function(){window.L.openCom("tip")(window.L.getText("\u5df2\u5728\u540e\u53f0\u53d1\u9001\uff0c\u53ef\u4ee5\u9000\u51fa\u5f53\u524d\u9875"));
window.setTimeout(function(){window.location.href="./mServerCtl.php?a=addMails"},3E3)},success:function(a){0<a?window.L.openCom("tip")(window.L.getText("\u53d1\u9001\u6210\u529f\uff01\u5171\u53d1\u51fa")+a+window.L.getText("\u5c01")):"noUser"==a?window.L.openCom("tip")(window.L.getText("\u6240\u9009\u7ec4\u4e0b\u6ca1\u6709\u8054\u7cfb\u4eba")):"noserver"==a?window.L.openCom("tip")(window.L.getText("\u8bf7\u914d\u7f6e\u90ae\u4ef6\u670d\u52a1\u5668")):(window.L.openCom("tip")(window.L.getText("\u53d1\u9001\u5931\u8d25")),
window.location.href="./mServerCtl.php?a=addMails")}})}function resetForm(){$("#select").val(0);$("#group_id").val("");$("#user_name").val("");$("#title").val("");$("#mailContent").val("");$("#AttachName").val("");$("#mailContent_Editer > p").html("")}
window.L.openCom("upload")("uploadfile",function(c,b){$.ajax({url:"./mServerCtl.php?a=saveAttachment",type:"POST",data:{fileUrl:c,name:b.fileObj.name},success:function(a){var b=$("#Attachment").val(),b=b+(","+a);","==b.substring(0,1)&&(b=b.substring(1,b.length));$("#Attachment").val(b)}});var a=$("#AttachName").val(),a=a+(","+b.fileObj.name);","==a.substring(0,1)&&(a=a.substring(1,a.length));$("#AttachName").val(a)},"*",'<img src="'+window.L._rootUrl+'/include/oFileManager/include/uploadify/Browse.jpg" />',
50,21,{auto:!0,queueID:!0,multi:!0,folder:"/attachment"});
